library(ggplot2)
library(raster)
library(dismo)
library(sp)
library(rJava)
library(dplyr)
library(stringr)
library(readxl)
library(tictoc)
library(readr)
library(tictoc)
library(xtable)
library(tidyr)
library(ggsci)

library(plot3D)

options(digits = 3)
#### DIRECTORIES ----------------------------------------------------------------------------- ####
data.processed.dir <- "data_processed/"
dcaip.dir <- "data_raw/climate/climate_dcaip/epsg3035/r1000/"

output.dir <- "outputs/"
manuscript.dir <- "manuscript/"

#### RAW DATA -------------------------------------------------------------------------------- ####
f.tbc.occ.creaf <- "data_raw/sp/TAXBAC.xlsx"
f.tbc.occ.usc <- "data_raw/sp/Punts_USC.xlsx"
f.raster.ref <- "data_raw/climate/climate_dcaip/epsg3035/r1000/tmax1.tif"
# CLIMA_CREIXEMENT.xlsx from Miquel Riba (2019.07.03), substitutes previous CLIMA_AB.xlsx
f.growth <- "data_raw/sp/CLIMA_CREIXEMENT.xlsx"

#### PROCESSED DATA -------------------------------------------------------------------------- ####
f.modelling.data <- "data_processed/whole_modelling_dataset.csv"

#### MODELLING SETS PARAMETERS  -------------------------------------------------------------- ####
predictors <- data.frame(rbind(
  cbind("clim", "data_raw/climate/bioclim_dcaip/epsg3035/r1000/bio12.tif", "AP", "Annual precipitation"),
  cbind("clim", "data_raw/climate/bioclim_dcaip/epsg3035/r1000/bio11.tif", "MeWiT", "Mean Temperature of Coldest Quarter"),
  cbind("clim", "data_raw/climate/bioclim_dcaip/epsg3035/r1000/bio15.tif", "PS", "Precipitation Seasonality (Coefficient of Variation)"),
  cbind("clim", "data_raw/climate/bioclim_dcaip/epsg3035/r1000/bio18.tif", "SuP", "Precipitation of Warmest Quarter"),
  cbind("clim", "data_raw/climate/bioclim_dcaip/epsg3035/r1000/bio4.tif", "TS", "Temperature Seasonality (standard deviation)"),
  cbind("bio", "data_raw/species_niche/current/que_hum_curr.tif", "que_hum_curr", "Quercus humilis"),
  cbind("bio", "data_raw/species_niche/current/que_pyr_curr.tif", "que_pyr_curr", "Quercus pyrenaica"),
  cbind("bio", "data_raw/species_niche/current/pin_pina_curr.tif", "pin_pina_curr", "Pinus pinea"),
  cbind("bio", "data_raw/species_niche/current/pin_nig_curr.tif", "pin_nig_curr", "Pinus nigra"),
  cbind("bio", "data_raw/species_niche/current/fag_syl_curr.tif", "fag_syl_curr", "Fagus sylvatica")), stringsAsFactors = F)
names(predictors) <- c("type", "original.file", "processed.file", "description")


# Group names
groups <- c("Continental", "Mild", "Sp")

# Number of percentiles (4 represents quartiles)
n.percentiles <- 10

# Models to run
models <- list()
models[["Clim"]] <- predictors %>% filter(type == 'clim') %>% pull(processed.file)
models[["ClimBio"]] <- predictors %>% pull(processed.file)

# Maxent model arguments
maxent.args <- c("linear=FALSE", "product=FALSE", "quadratic=FALSE",
                 "hinge=TRUE", "threshold=FALSE", "addSamplesToBackground=FALSE",
                 "responsecurves=TRUE", "writeplotdata","pictures=TRUE", "jackknife=TRUE",
                 paste0("projectionlayers=", paste0(data.processed.dir, "predictors")))

#### RESULT FILES ---------------------------------------------------------------------------- ####
f.maxent.models.results <- paste0(output.dir, "maxent/maxent_models_fitting_results.csv")
f.maxentPred.models.results <- paste0(output.dir, "maxentPred/maxent_models_fitting_results.csv")
f.suit.growth.corr <- paste0(output.dir, "maxentPred/suitability-growth_corr.csv")
f.range.size <- paste0(output.dir, "maxentPred/models_areas.csv")

#### IBERIAN PENINSULA BOUNDARIES ------------------------------------------------------------ ####
# Iberian peninsula boundaries
ip <- rbind(c(2770041.31879346,2282217.32415549),
            c(2767308.09031736,2280822.7684419),
            c(2765759.60803387,2277613.31941642),
            c(2763245.02999846,2268242.07710677),
            c(2763591.24114518,2264391.87565959),
            c(2765291.99205979,2251931.78980159),
            c(2764619.55842373,2236037.31640718),
            c(2762155.38359603,2230075.49390999),
            c(2762938.58841437,2204721.05652003),
            c(2764271.5348913,2199936.60585721),
            c(2764484.75648559,2194532.99404147),
            c(2764011.43711586,2184997.01877439),
            c(2763064.05809884,2181652.04750405),
            c(2762063.46110153,2179098.871841),
            c(2760194.4921456,2174728.42147091),
            c(2758631.95916933,2171344.82420821),
            c(2756641.95669813,2167361.71502573),
            c(2742538.51517515,2138628.55839375),
            c(2739809.78543522,2132939.69352364),
            c(2732730.1482237,2118840.50840629),
            c(2730011.18557769,2113719.52215121),
            c(2723740.23377187,2092113.56350755),
            c(2718858.57061489,2084222.63279975),
            c(2712675.99454405,2074531.79822566),
            c(2709873.13320711,2070180.01775518),
            c(2708235.78533919,2067671.03090437),
            c(2705015.11299043,2062965.54224225),
            c(2699298.89989558,2054637.84965753),
            c(2692671.25620147,2042608.14713638),
            c(2692625.4909138,2039845.75596338),
            c(2687497.30324477,2034399.87081654),
            c(2684682.63168879,2031820.62934184),
            c(2674843.83278777,2025035.22091063),
            c(2670180.13785204,2022575.81855535),
            c(2662872.27374186,2010665.53577671),
            c(2660940.15171757,2004820.90944724),
            c(2658014.12489408,1999708.95629503),
            c(2653997.12717912,1994585.64439643),
            c(2650577.77734149,1988704.9271824),
            c(2647670.57307354,1976590.26121168),
            c(2642575.62580522,1968253.58676793),
            c(2639775.0351963,1964684.33342433),
            c(2636848.26195893,1961301.93873039),
            c(2636044.79491833,1952710.0354285),
            c(2638852.96987093,1950411.77381713),
            c(2649711.60535693,1946187.67019891),
            c(2657531.29692212,1944656.35699158),
            c(2654584.10932799,1942605.67031315),
            c(2655251.21754732,1939834.35635633),
            c(2656305.54303363,1936391.45714174),
            c(2657151.88896627,1930114.5983208),
            c(2656997.65520983,1926990.20977446),
            c(2655992.29096719,1922899.73788639),
            c(2654809.98529293,1920448.2702095),
            c(2655735.64684569,1915836.31343046),
            c(2664638.09906313,1914183.61976745),
            c(2670655.59210598,1915300.58665271),
            c(2675922.28630179,1916913.26584027),
            c(2678577.76312256,1919041.84380337),
            c(2680559.45524592,1919600.75708404),
            c(2691634.18760527,1919134.62953526),
            c(2694574.34149425,1916243.45344623),
            c(2696338.23798136,1906415.20176556),
            c(2685475.3420198,1892567.70812118),
            c(2684779.52238987,1887912.75917544),
            c(2684193.48294701,1885218.58614889),
            c(2682727.26161063,1880836.00979243),
            c(2681505.46040256,1877976.98410408),
            c(2680259.81190486,1875336.60017108),
            c(2678770.96622104,1872629.34291194),
            c(2676217.99862876,1868259.41016184),
            c(2674300.45111306,1851856.6594512),
            c(2673993.31564634,1846980.49947591),
            c(2670470.46670489,1832892.0048832),
            c(2666756.64316535,1821785.33138988),
            c(2665415.97502464,1817715.23945622),
            c(2666032.84141628,1814964.73504386),
            c(2666489.95583022,1810569.73372613),
            c(2663169.56310249,1801214.6857768),
            c(2660647.14519247,1796854.12269367),
            c(2653359.77473283,1783283.01959221),
            c(2647048.62398604,1773126.16560442),
            c(2644316.55222975,1769501.19872558),
            c(2639698.61501128,1764464.83233136),
            c(2642254.14215995,1758469.98618199),
            c(2645261.80146717,1759943.98117259),
            c(2650244.26063453,1760935.89488006),
            c(2669134.93819268,1762857.71436017),
            c(2671619.63789012,1762777.28352861),
            c(2677522.36508923,1760421.33506985),
            c(2680528.00943133,1758016.93434174),
            c(2684918.38082243,1755452.57030189),
            c(2686835.17978062,1754743.21277462),
            c(2689671.46650415,1754577.00320229),
            c(2708413.10158152,1749942.15927579),
            c(2714922.15184438,1745548.78285957),
            c(2716951.0395342,1743548.62240067),
            c(2722230.64008031,1737526.75300767),
            c(2724219.10827014,1735055.00974122),
            c(2726500.98407843,1732518.72144839),
            c(2731125.90930304,1730004.93727414),
            c(2737986.93846025,1732117.55146169),
            c(2747401.94733184,1736578.64189261),
            c(2761328.30528488,1743090.40818164),
            c(2768901.91102435,1744379.83743803),
            c(2772506.37035202,1744445.02070943),
            c(2774528.10878145,1744039.16605149),
            c(2777781.49052303,1743726.21696111),
            c(2785192.00851252,1743395.08357311),
            c(2789328.78769964,1743397.219404),
            c(2795694.62813994,1742395.66428029),
            c(2800156.0993391,1741613.07034179),
            c(2810223.61682093,1739149.64486078),
            c(2822907.20932902,1730264.28460337),
            c(2829393.77287192,1725346.69273472),
            c(2831711.09196867,1723366.90054551),
            c(2839715.0098546,1715673.85225499),
            c(2844974.03034839,1710549.13442788),
            c(2847534.97585715,1707669.56857766),
            c(2851487.65826401,1702744.47306351),
            c(2855103.37674126,1695893.9932613),
            c(2856328.8110822,1691327.46689436),
            c(2857635.4011867,1684763.88662711),
            c(2860798.01260162,1681412.97858528),
            c(2853306.15698792,1677067.01178271),
            c(2854927.99474497,1666433.05197762),
            c(2856437.82517724,1663763.57150812),
            c(2858125.37045648,1662760.10775691),
            c(2861279.09468772,1661773.53732693),
            c(2867648.64443526,1656253.56650611),
            c(2871601.20281901,1647668.78634748),
            c(2866876.64740442,1643307.61372416),
            c(2863883.33262567,1644286.14358331),
            c(2864988.10112112,1637421.02060237),
            c(2876461.35098267,1610209.51244844),
            c(2881689.64864199,1607295.66122388),
            c(2883983.83840213,1607351.36838273),
            c(2892932.35195199,1599244.88884863),
            c(2903159.49975053,1589431.97684603),
            c(2911297.51606673,1581944.04027529),
            c(2913824.65145604,1582155.17872792),
            c(2924298.97416703,1584183.91446928),
            c(2927642.21292411,1587652.62017265),
            c(2928413.29331288,1594107.2659603),
            c(2930134.04981111,1596491.37851164),
            c(2932201.70440667,1597234.08039158),
            c(2934317.74885225,1596679.53631279),
            c(2936500.06013258,1594394.59915643),
            c(2941496.17591505,1600753.50063804),
            c(2948271.67723357,1608282.88854744),
            c(2952427.94162756,1614184.05259844),
            c(2957553.96019255,1618253.991777),
            c(2962642.45780533,1618908.78336475),
            c(2971076.55655753,1620895.52448237),
            c(2980564.72704042,1623362.57191947),
            c(2983671.84582806,1623471.46282954),
            c(2987036.01093314,1622953.21137249),
            c(2991971.64319459,1620723.18716777),
            c(2996058.09745847,1618748.35725607),
            c(3000835.35724829,1618146.80306009),
            c(3006175.57349589,1619180.2977507),
            c(3020128.42324009,1627195.96333105),
            c(3025473.86313444,1632774.21403322),
            c(3029602.5000942,1637469.76111401),
            c(3032731.34604717,1638208.22246885),
            c(3036100.60761843,1636985.39974718),
            c(3045033.99848486,1634527.42208627),
            c(3058250.45657743,1634093.69266986),
            c(3060897.06679449,1635649.00717912),
            c(3083486.01332025,1632122.50981883),
            c(3086515.25997082,1630568.31549022),
            c(3088465.78696783,1628840.16646598),
            c(3106626.64659459,1623770.88337224),
            c(3113876.9205963,1620040.91710912),
            c(3118190.71523296,1619398.74869154),
            c(3121237.42647775,1620749.19031255),
            c(3126856.17486976,1622970.09198763),
            c(3134149.41039181,1623283.97473978),
            c(3138244.28042943,1622064.87144558),
            c(3144922.61696276,1621046.3959335),
            c(3150828.0829193,1619611.51407407),
            c(3156943.50099981,1618195.13251859),
            c(3160160.42724046,1617878.86222586),
            c(3166364.26179478,1614339.18555019),
            c(3170354.23399401,1611453.95740327),
            c(3175785.96194314,1607937.07973088),
            c(3181773.26355008,1607156.27891633),
            c(3186709.64244635,1608394.65540956),
            c(3189892.10479193,1611105.61673288),
            c(3191330.88439552,1613863.56595923),
            c(3192788.72387145,1616376.06418463),
            c(3195454.83312178,1619095.89954949),
            c(3203913.3770152,1620683.50298601),
            c(3214579.20995974,1619491.60891925),
            c(3217993.11888677,1618001.65153272),
            c(3220463.00576696,1615835.13722122),
            c(3223043.07405973,1612297.40158671),
            c(3224565.10856402,1609626.8954167),
            c(3225651.29558981,1607381.50935153),
            c(3227389.46952206,1604382.33340429),
            c(3233537.62332098,1604174.48537183),
            c(3240123.6437264,1609524.38911932),
            c(3253997.09417927,1624050.56021914),
            c(3261062.4200158,1634284.90336247),
            c(3263379.20355405,1638431.26960263),
            c(3266234.58909819,1644274.91419903),
            c(3270827.95590571,1654156.31216718),
            c(3282750.83617265,1665736.22096457),
            c(3286700.86753671,1667598.43613435),
            c(3303739.4829956,1677301.03105495),
            c(3314676.22963639,1683274.73584321),
            c(3316790.46295605,1683976.40834601),
            c(3324570.08362679,1684524.25292333),
            c(3327436.48997907,1683703.00620342),
            c(3335932.92908604,1681902.48491245),
            c(3348405.10480812,1682911.12493201),
            c(3357119.74448606,1679789.46297861),
            c(3370314.39233757,1680939.74234728),
            c(3372525.31816914,1683545.33079987),
            c(3371257.72234969,1687196.59375131),
            c(3369557.51004559,1684447.91741454),
            c(3364381.05987339,1687545.20187818),
            c(3362553.08425973,1689626.43764165),
            c(3359974.21492907,1695062.9308716),
            c(3361492.51507271,1698021.45426641),
            c(3366775.22983693,1704326.73859075),
            c(3370460.7766494,1709013.63303428),
            c(3372006.0739805,1713293.87269889),
            c(3377773.29233174,1720556.8744905),
            c(3383578.97816357,1732066.55269446),
            c(3387921.0258949,1742016.62243888),
            c(3399361.2644325,1757874.1264053),
            c(3412348.68588522,1768435.28987739),
            c(3417797.44159416,1771229.48714768),
            c(3420006.99209419,1772158.76615905),
            c(3432390.8371499,1775656.79890085),
            c(3440990.08152042,1779125.02420838),
            c(3454797.58751947,1786646.83802519),
            c(3466708.25277227,1793454.82038118),
            c(3466550.01936935,1801550.35468346),
            c(3463000.29997332,1804750.83301135),
            c(3458354.32688733,1808133.02164008),
            c(3454157.10447724,1809434.31830461),
            c(3448691.82126696,1811833.72163808),
            c(3445458.73892978,1815456.43337762),
            c(3443927.91942387,1817550.15648517),
            c(3441801.56264228,1820686.33579002),
            c(3439494.03389532,1824576.0442316),
            c(3436317.34802189,1832245.33534426),
            c(3434829.28405648,1837301.50499484),
            c(3433690.92968289,1842497.86774074),
            c(3429561.36178802,1869962.38152718),
            c(3429071.46638135,1876102.12281366),
            c(3431967.9537458,1885893.83738731),
            c(3438604.71796938,1896143.56938931),
            c(3441514.42577419,1898400.76680474),
            c(3446440.25278201,1907735.39830113),
            c(3452846.20347366,1916049.7388229),
            c(3455808.93491806,1919513.96050002),
            c(3465727.94298329,1931144.91690755),
            c(3470246.31606096,1938426.854528),
            c(3484261.85178495,1951963.72339304),
            c(3487722.05941988,1954038.33894806),
            c(3497440.80786142,1962872.56582646),
            c(3500684.79895387,1966614.62635727),
            c(3515406.07396156,1985942.47792007),
            c(3516603.14080335,1988703.65429728),
            c(3518288.60467574,1991325.05095897),
            c(3524374.8005157,1996617.50144517),
            c(3532096.6251408,1997305.87821846),
            c(3534241.08641539,1996260.77939631),
            c(3532324.30380583,1991987.41864534),
            c(3545884.01221437,2000413.29481988),
            c(3547531.58630529,2005020.75173498),
            c(3536959.42486862,2011549.70964414),
            c(3535164.30291361,2014602.98137614),
            c(3550277.89520221,2029672.06084244),
            c(3560696.41220198,2037968.78425818),
            c(3567320.57012579,2040659.62839524),
            c(3581315.74478712,2043204.45269069),
            c(3591077.33183459,2045137.61018092),
            c(3603298.05472404,2047759.40016583),
            c(3607582.58621102,2048694.5069413),
            c(3610305.65539307,2049021.94583531),
            c(3618795.30766427,2049423.95835614),
            c(3622370.97106715,2049965.95817319),
            c(3633829.99462987,2052281.09557439),
            c(3643836.74004434,2054162.58325559),
            c(3645832.98990601,2054154.82141724),
            c(3647945.59696932,2053886.68482252),
            c(3650590.87739223,2053792.70960155),
            c(3653158.12622418,2054056.89453041),
            c(3655855.89460577,2054630.39216249),
            c(3658902.68991123,2055565.79631852),
            c(3661654.34534442,2057677.22532948),
            c(3665394.15590207,2063895.20387808),
            c(3673514.45086025,2072724.08473425),
            c(3691546.59127369,2080840.92461969),
            c(3699305.95088226,2083725.18028468),
            c(3713770.81758871,2088470.41619039),
            c(3718887.63546579,2091143.23794906),
            c(3722563.9796578,2093914.74097842),
            c(3725272.97845166,2094534.48923021),
            c(3727725.27965967,2094492.80120747),
            c(3731100.13786425,2095434.64546727),
            c(3744389.1939693,2106371.86623253),
            c(3747916.92953828,2108766.34920616),
            c(3753338.0014245,2110903.50452635),
            c(3756009.11953577,2113624.20874977),
            c(3757373.81351735,2116334.6133547),
            c(3758768.80805163,2120783.63077575),
            c(3756929.56272369,2130796.44183378),
            c(3752465.67203618,2138628.22477576),
            c(3751212.65411116,2140388.42788995),
            c(3750825.79461632,2142908.05263587),
            c(3750881.05152882,2146414.471327),
            c(3751966.41612579,2150688.23777388),
            c(3753406.29872085,2152820.92130495),
            c(3756382.61605397,2154032.01913327),
            c(3760138.79715014,2150565.15934757),
            c(3763982.2299943,2150818.94468545),
            c(3766050.11092699,2153504.26455516),
            c(3769190.96467822,2159601.28797419),
            c(3765650.26197489,2161879.4760407),
            c(3762264.78945315,2163558.23255117),
            c(3759822.68487115,2162407.26398718),
            c(3756745.50133135,2165117.49842947),
            c(3756470.88589888,2167905.27446148),
            c(3758348.87546816,2173272.34902833),
            c(3754072.5055179,2173800.5289879),
            c(3741191.53140561,2179125.43086363),
            c(3731098.05414506,2178486.82974456),
            c(3720240.95660804,2174856.37162911),
            c(3716887.37021678,2173272.24741546),
            c(3715508.91462415,2170429.82668842),
            c(3704652.43701761,2167041.79220442),
            c(3700402.64501419,2168966.71248694),
            c(3698437.57879264,2171753.11204661),
            c(3695532.0244009,2174517.76792058),
            c(3683035.66889296,2180988.23815641),
            c(3674611.80013588,2180029.66368904),
            c(3671410.14860184,2177908.65348888),
            c(3666001.40664427,2174055.95004733),
            c(3660619.18126262,2174419.10941888),
            c(3658714.4906002,2176802.78741712),
            c(3656488.99509585,2183654.21547857),
            c(3647320.75800855,2190305.68001038),
            c(3639913.72560889,2192012.04772876),
            c(3634218.40526889,2189530.71648442),
            c(3625123.57627689,2186555.0693781),
            c(3621853.46852512,2186773.49933593),
            c(3616860.30084643,2188232.53217873),
            c(3615887.29239403,2193193.04469249),
            c(3617894.66763934,2206399.17360219),
            c(3616533.77037606,2212352.67825626),
            c(3614667.73839285,2216420.72485669),
            c(3611426.5924112,2220317.96203076),
            c(3603249.1290344,2221738.17368496),
            c(3597949.14510107,2220974.6929362),
            c(3593880.07307557,2226803.20336185),
            c(3591030.55622674,2229550.96195212),
            c(3582687.35204652,2231741.81298644),
            c(3578227.36931003,2232331.47562861),
            c(3573538.41044166,2236057.98651184),
            c(3569609.69851177,2238424.54068452),
            c(3562115.814866,2241796.10033708),
            c(3558247.13377328,2240500.11152727),
            c(3556006.91269483,2230804.19080672),
            c(3556524.1024918,2224842.36664847),
            c(3538729.38331052,2226080.61681951),
            c(3534815.3087615,2226680.77558934),
            c(3516904.49130337,2233677.88138618),
            c(3513508.86318282,2232402.71784491),
            c(3510574.92246586,2231605.42968303),
            c(3506517.34312912,2230659.15372121),
            c(3501171.78353888,2230029.31429065),
            c(3496843.94194319,2231629.3516259),
            c(3493436.22278364,2236286.34080554),
            c(3488532.6213605,2242962.7270887),
            c(3485541.66888966,2244814.50678592),
            c(3478579.48477999,2250924.77571275),
            c(3473540.8649717,2248275.55338319),
            c(3471503.58856409,2247359.52953077),
            c(3467360.17611557,2247026.0062983),
            c(3457115.32552672,2246854.61346877),
            c(3445443.63281628,2262204.53852276),
            c(3446015.96022044,2266822.5571841),
            c(3444118.50627093,2269661.98121793),
            c(3441522.27373132,2269565.04484736),
            c(3439823.08852108,2268634.60360909),
            c(3435578.31294305,2268947.3193032),
            c(3429211.196693,2270150.47256687),
            c(3424888.43705776,2273353.38498616),
            c(3420704.70196632,2276316.88290465),
            c(3411931.76191133,2282024.85527674),
            c(3408730.3074213,2283975.82670368),
            c(3401230.15072333,2287362.30613059),
            c(3396036.35352564,2283795.77209287),
            c(3390156.01277883,2286471.48918192),
            c(3388656.43029781,2289684.90683921),
            c(3388981.65661115,2292003.69702883),
            c(3391791.17833473,2293639.28963631),
            c(3393589.72777428,2295220.81452028),
            c(3396373.93434104,2301223.28868138),
            c(3398123.76836378,2305916.06326457),
            c(3397147.12721505,2309757.78037272),
            c(3376572.47146693,2318672.93761706),
            c(3373531.70878685,2318672.77523271),
            c(3371211.87873816,2317610.13531046),
            c(3367358.80146758,2324098.09291707),
            c(3366838.62550473,2327682.19022652),
            c(3359849.42122894,2325804.84718849),
            c(3356089.08918257,2324085.28494298),
            c(3340055.27387953,2322562.92915016),
            c(3333974.53185039,2323061.06212133),
            c(3324542.15263231,2325005.60582566),
            c(3320733.5789852,2326220.19416543),
            c(3316059.64034604,2329916.72686666),
            c(3309850.685894,2336675.41270514),
            c(3307513.32606714,2336937.14616247),
            c(3301370.78904338,2339712.37520699),
            c(3296396.51572246,2342155.90440705),
            c(3292994.85443091,2345073.88249744),
            c(3291506.82903312,2347637.29249856),
            c(3278190.2616593,2348945.86962127),
            c(3276017.17222447,2348999.05978259),
            c(3270282.50435526,2344228.84089712),
            c(3262333.85533663,2343284.96595845),
            c(3257969.71918067,2342918.48842942),
            c(3253602.74836337,2346289.9186626),
            c(3238775.88199956,2353751.1094403),
            c(3235726.10123066,2356249.15314625),
            c(3234645.89153117,2359958.82058181),
            c(3231540.29324759,2363582.59372906),
            c(3229319.52478329,2365623.86625968),
            c(3226678.33326299,2366306.85209052),
            c(3208115.68588002,2368011.36365623),
            c(3196452.33008101,2366507.72492151),
            c(3194201.14080001,2364990.80955577),
            c(3175510.12242815,2363519.6623737),
            c(3169485.23006609,2363631.92982623),
            c(3166772.67595996,2364205.27319771),
            c(3163646.77223801,2365438.25217034),
            c(3158229.65351982,2366594.36045581),
            c(3150897.63456976,2367575.4802529),
            c(3145327.71713259,2368864.41769644),
            c(3142636.83833461,2369700.03672127),
            c(3139330.27067569,2370802.28005736),
            c(3133279.94611018,2373694.74511763),
            c(3129359.42930679,2376231.32831559),
            c(3125414.26634109,2378530.65348247),
            c(3118849.96715799,2381252.88126633),
            c(3115946.74375248,2382231.76956562),
            c(3101568.48045147,2386916.37533245),
            c(3093212.59092842,2393456.22193222),
            c(3091529.0104952,2395450.21364799),
            c(3082719.29392449,2399787.67517383),
            c(3068430.80739461,2402028.06868975),
            c(3063933.73865036,2402470.34534354),
            c(3054464.26532765,2411982.56230699),
            c(3048545.71355601,2415833.93430492),
            c(3040124.29985025,2411646.71503537),
            c(3027026.93268612,2411608.84765705),
            c(3006425.30058383,2416187.63206822),
            c(2997587.77663008,2417478.45725303),
            c(2993980.64082007,2418116.37154522),
            c(2982599.67936965,2422032.89134778),
            c(2975268.99416138,2424706.72300099),
            c(2962915.63677616,2427956.26390799),
            c(2954929.02642221,2426956.98031728),
            c(2952062.23220865,2428901.02714747),
            c(2947364.98073547,2429546.40070609),
            c(2944663.2261614,2430157.04042142),
            c(2939967.57586191,2432433.45237582),
            c(2935187.69216964,2436757.18073267),
            c(2932358.36764158,2443038.28469865),
            c(2924478.35514413,2454327.25427639),
            c(2920501.19737187,2456545.88854947),
            c(2911888.62378351,2460702.43251631),
            c(2909056.75788317,2461076.49751558),
            c(2906131.60488445,2461289.36474281),
            c(2893553.46914976,2461648.08467821),
            c(2894291.17252523,2466193.05601151),
            c(2891771.73313549,2466962.19389182),
            c(2877683.8424753,2463539.36735036),
            c(2872307.9708444,2458313.23453302),
            c(2868727.28048797,2456153.23307251),
            c(2861801.12519437,2452902.20565173),
            c(2858108.66202153,2451455.56463001),
            c(2855550.55872166,2452013.70957311),
            c(2852141.99016654,2448525.68965627),
            c(2850141.40396707,2442488.15796168),
            c(2860922.4788462,2441247.81423996),
            c(2858070.48088081,2433201.64358306),
            c(2854207.21880461,2429747.65149314),
            c(2847126.44497477,2434177.39618591),
            c(2830212.82309252,2430582.4391784),
            c(2815965.15474515,2431492.14588756),
            c(2813583.05040503,2432526.15195455),
            c(2810921.01469753,2434299.18776217),
            c(2809622.57283379,2435832.63702518),
            c(2808511.2857891,2438370.10889318),
            c(2806612.20044771,2439327.73229298),
            c(2801324.48482082,2438853.46950903),
            c(2794648.41650126,2433842.42117874),
            c(2790798.56343795,2430483.07022467),
            c(2786827.75673246,2427541.65745266),
            c(2781477.31215029,2429227.35733203),
            c(2777732.52892773,2429192.05151577),
            c(2773450.70268742,2427812.57586667),
            c(2768994.32353827,2420996.85130584),
            c(2766883.67294045,2416941.41749537),
            c(2760460.52960875,2403727.64597344),
            c(2761530.1251578,2398772.4520453),
            c(2763050.18852899,2401984.41432676),
            c(2766523.94234566,2403716.29188686),
            c(2770163.19143299,2402080.4162065),
            c(2772358.52991607,2399048.3253312),
            c(2772695.28796228,2388750.63634713),
            c(2770786.77458311,2387372.10864305),
            c(2772163.19728134,2380459.43420466),
            c(2775708.54822152,2373311.77575078),
            c(2769543.12693233,2361516.68317956),
            c(2771018.24619203,2354626.73218635),
            c(2775022.66410174,2356077.91819133),
            c(2780727.33286001,2362295.77436036),
            c(2784398.04745372,2364997.32273768),
            c(2790507.45396086,2368041.4488873),
            c(2791089.5399989,2364325.5949165),
            c(2792921.08270117,2362651.37860655),
            c(2796669.54472358,2362799.57687807),
            c(2788552.93173818,2347871.52313359),
            c(2783865.02782912,2347510.12028378),
            c(2781813.25412393,2349172.09423098),
            c(2777040.36097089,2346856.2190686),
            c(2782763.36455197,2336085.48550655),
            c(2788296.2064597,2335244.09802698),
            c(2792616.85723372,2337355.14153837),
            c(2793999.4989093,2334313.41289529),
            c(2784802.48780442,2329225.46807026),
            c(2779142.84217637,2327378.77826735),
            c(2777340.50756377,2323128.83739181),
            c(2782950.47618176,2320203.40340858),
            c(2792319.34554996,2322310.70401647),
            c(2783405.92993404,2316178.94804744),
            c(2780191.59703504,2314466.93934728),
            c(2771476.46673814,2307132.9405594),
            c(2770251.68445822,2303469.10345779),
            c(2767530.86616913,2288719.73584128),
            c(2766909.4164112,2281650.72879856),
            c(2770041.31879346,2282217.32415549))
ip.df <- as.data.frame(ip)
names(ip.df) <- c("x", "y")
